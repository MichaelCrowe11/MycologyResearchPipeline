{% extends "base.html" %}

{% block title %}Membership Plans - MycosPipeline{% endblock %}

{% block extra_css %}
<style>
    .pricing-card {
        border: 2px solid transparent;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }
    
    .pricing-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
    }
    
    .pricing-card.featured {
        border-color: #007bff;
        transform: scale(1.05);
    }
    
    .pricing-card.featured::before {
        content: 'Most Popular';
        position: absolute;
        top: 0;
        right: 0;
        background: linear-gradient(135deg, #007bff, #0056b3);
        color: white;
        padding: 0.5rem 1rem;
        font-size: 0.8rem;
        font-weight: bold;
        transform: translateX(30%) translateY(-50%) rotate(45deg);
        transform-origin: center;
        width: 150px;
        text-align: center;
    }
    
    .price-display {
        font-size: 3rem;
        font-weight: 700;
        background: linear-gradient(135deg, #007bff, #28a745);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }
    
    .feature-list {
        list-style: none;
        padding: 0;
    }
    
    .feature-list li {
        padding: 0.5rem 0;
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    }
    
    .feature-list li:before {
        content: 'âœ“';
        color: #28a745;
        font-weight: bold;
        margin-right: 0.5rem;
    }
    
    .upgrade-btn {
        background: linear-gradient(135deg, #007bff, #28a745);
        border: none;
        color: white;
        padding: 1rem 2rem;
        border-radius: 50px;
        font-weight: 600;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
    }
    
    .upgrade-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0, 123, 255, 0.4);
        color: white;
    }
    
    .current-plan {
        background: linear-gradient(135deg, #28a745, #20c997);
        color: white;
    }
</style>
{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="text-center mb-5">
        <h1 class="display-4 fw-bold">Choose Your Research Plan</h1>
        <p class="lead">Unlock the full potential of mycological research with our advanced platform</p>
    </div>
    
    <!-- Current Plan Status -->
    {% if current_user.is_authenticated %}
    <div class="row mb-5">
        <div class="col-12">
            <div class="alert alert-info">
                <h5><i class="fas fa-info-circle me-2"></i>Current Plan Status</h5>
                <p class="mb-0">
                    You are currently on the <strong>{{ current_tier.title() }}</strong> plan.
                    {% if current_tier != 'free' %}
                        <a href="{{ url_for('payment.customer_portal') }}" class="btn btn-sm btn-outline-info ms-2">
                            <i class="fas fa-cog me-1"></i>Manage Subscription
                        </a>
                    {% endif %}
                </p>
            </div>
        </div>
    </div>
    {% endif %}
    
    <!-- Pricing Plans -->
    <div class="row g-4 justify-content-center">
        <!-- Free Plan -->
        <div class="col-lg-3 col-md-6">
            <div class="card pricing-card h-100 {% if current_tier == 'free' %}current-plan{% endif %}">
                <div class="card-header text-center bg-light">
                    <h3>Free Researcher</h3>
                    <div class="price-display">$0</div>
                    <small class="text-muted">per month</small>
                </div>
                <div class="card-body">
                    <ul class="feature-list">
                        <li>Basic sample management</li>
                        <li>Up to 10 samples</li>
                        <li>Community support</li>
                        <li>Basic documentation access</li>
                    </ul>
                </div>
                <div class="card-footer text-center">
                    {% if current_tier == 'free' %}
                        <button class="btn btn-success" disabled>Current Plan</button>
                    {% else %}
                        <button class="btn btn-outline-secondary" disabled>Downgrade Available</button>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <!-- Basic Plan -->
        <div class="col-lg-3 col-md-6">
            <div class="card pricing-card h-100 {% if current_tier == 'basic' %}current-plan{% endif %}">
                <div class="card-header text-center">
                    <h3>{{ membership_tiers.basic.name }}</h3>
                    <div class="price-display">${{ membership_tiers.basic.price }}</div>
                    <small class="text-muted">per month</small>
                </div>
                <div class="card-body">
                    <ul class="feature-list">
                        {% for feature in membership_tiers.basic.features %}
                        <li>{{ feature }}</li>
                        {% endfor %}
                    </ul>
                </div>
                <div class="card-footer text-center">
                    {% if current_tier == 'basic' %}
                        <button class="btn btn-success" disabled>Current Plan</button>
                    {% else %}
                        <form method="POST" action="{{ url_for('payment.create_checkout_session') }}">
                            <input type="hidden" name="tier" value="basic">
                            <button type="submit" class="upgrade-btn">
                                {% if current_tier == 'free' %}Upgrade Now{% else %}Switch Plan{% endif %}
                            </button>
                        </form>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <!-- Pro Plan (Featured) -->
        <div class="col-lg-3 col-md-6">
            <div class="card pricing-card featured h-100 {% if current_tier == 'pro' %}current-plan{% endif %}">
                <div class="card-header text-center bg-primary text-white">
                    <h3>{{ membership_tiers.pro.name }}</h3>
                    <div class="price-display text-white">${{ membership_tiers.pro.price }}</div>
                    <small>per month</small>
                </div>
                <div class="card-body">
                    <ul class="feature-list">
                        {% for feature in membership_tiers.pro.features %}
                        <li>{{ feature }}</li>
                        {% endfor %}
                    </ul>
                </div>
                <div class="card-footer text-center">
                    {% if current_tier == 'pro' %}
                        <button class="btn btn-success" disabled>Current Plan</button>
                    {% else %}
                        <form method="POST" action="{{ url_for('payment.create_checkout_session') }}">
                            <input type="hidden" name="tier" value="pro">
                            <button type="submit" class="upgrade-btn">
                                {% if current_tier in ['free', 'basic'] %}Upgrade Now{% else %}Switch Plan{% endif %}
                            </button>
                        </form>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <!-- Enterprise Plan -->
        <div class="col-lg-3 col-md-6">
            <div class="card pricing-card h-100 {% if current_tier == 'enterprise' %}current-plan{% endif %}">
                <div class="card-header text-center bg-dark text-white">
                    <h3>{{ membership_tiers.enterprise.name }}</h3>
                    <div class="price-display text-white">${{ membership_tiers.enterprise.price }}</div>
                    <small>per month</small>
                </div>
                <div class="card-body">
                    <ul class="feature-list">
                        {% for feature in membership_tiers.enterprise.features %}
                        <li>{{ feature }}</li>
                        {% endfor %}
                    </ul>
                </div>
                <div class="card-footer text-center">
                    {% if current_tier == 'enterprise' %}
                        <button class="btn btn-success" disabled>Current Plan</button>
                    {% else %}
                        <form method="POST" action="{{ url_for('payment.create_checkout_session') }}">
                            <input type="hidden" name="tier" value="enterprise">
                            <button type="submit" class="upgrade-btn">
                                {% if current_tier in ['free', 'basic', 'pro'] %}Upgrade Now{% else %}Switch Plan{% endif %}
                            </button>
                        </form>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}